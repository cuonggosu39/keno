<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Keno ‚Äì Th·ªëng k√™ Hot / Cold</title>

<style>
:root{
  --cell-width:75px;
  --cell-height:55px;
  --font-btn:18px;
  --font-cell:22px;
}

body{
  font-family: Arial, sans-serif;
  background:#fff;
  margin:0;
  padding:15px;
  text-align:center;
}

h2{ margin-bottom:10px; }

button{
  font-size:var(--font-btn);
  padding:8px 18px;
  margin:6px;
  cursor:pointer;
  border-radius:6px;
}

#info{
  font-size:22px;
  font-weight:bold;
  margin:10px 0;
  white-space:pre-line;
}

.nav{ margin-bottom:10px; }

#board{
  margin:0 auto;
  border-collapse:collapse;
}

#board td{
  width:var(--cell-width);
  height:var(--cell-height);
  border:1px solid #aaa;
  font-size:var(--font-cell);
  text-align:center;
  vertical-align:middle;
  position: relative;
}

#board td:nth-child(5){ border-right:3px solid #000; }
#board tr:nth-child(4) td{ border-bottom:3px solid #000; }

.hit{ background:#4caf50; color:#fff; }

.prev-hit{
  text-decoration: underline;
  text-decoration-thickness: 3px;
  text-underline-offset: 6px;
}

/* HOT */
.hot1{ color:#ffcc80; font-weight:bold; }
.hot2{ color:#ff9800; font-weight:bold; }
.hot3{ color:#e65100; font-weight:bold; }

/* COLD */
.cold1{ color:#90caf9; }
.cold2{ color:#1e88e5; font-weight:bold; }
.cold3{ color:#0d47a1; font-weight:bold; }

/* GAN L√ÇU NH·∫§T TUY·ªÜT ƒê·ªêI */
.max-cold{
  color:#b71c1c;
  font-weight:900;
}

.note{
  max-width:1200px;
  margin:20px auto;
  font-size:16px;
  line-height:1.6;
  text-align:left;
  padding:0 10px;
}

@media (max-width:600px){
  :root{
    --cell-width:50px;
    --cell-height:45px;
    --font-btn:22px;
    --font-cell:16px;
  }
  #info{ font-size:18px; }
  button{ padding:10px 22px; }
  .note{ font-size:14px; }
}

@media (min-width:1800px){
  :root{
    --cell-width:90px;
    --cell-height:60px;
    --font-btn:28px;
    --font-cell:30px;
  }
  #info{ font-size:32px; }
  .note{ font-size:20px; }
}
</style>
</head>

<body>

<h2>Keno ‚Äì Th·ªëng k√™ Hot / Cold (10 k·ª≥ g·∫ßn nh·∫•t)</h2>

<div id="info"></div>

<div class="nav">
  <button onclick="newer()">‚óÄ</button>
  <button onclick="older()">‚ñ∂</button>
</div>

<table id="board"></table>

<div class="note">
<b>Gi·∫£i th√≠ch cho kh√°ch xem:</b><br><br>
üü¢ <b>N·ªÅn xanh</b>: s·ªë tr√∫ng k·ª≥ ƒëang xem<br>
‚ñ¨ <b>G·∫°ch ch√¢n</b>: s·ªë tr√∫ng k·ª≥ li·ªÅn tr∆∞·ªõc<br><br>
üî• <b>HOT</b>: xu·∫•t hi·ªán nhi·ªÅu trong 10 k·ª≥ g·∫ßn nh·∫•t<br>
‚ùÑ <b>COLD</b>: s·ªë gan (ch∆∞a xu·∫•t hi·ªán)<br>
üî¥ <b>S·ªë ƒë·ªè</b>: gan l√¢u nh·∫•t trong 10 k·ª≥<br><br>
<i>K·∫øt qu·∫£ ch·ªâ mang t√≠nh tham kh·∫£o.</i>
</div>

<textarea id="raw" style="display:none;"></textarea>

<script>
let results=[];
let index=0;
const WINDOW=10;

function parseData(){
  let lines=document.getElementById("raw").value.replace(/\u00A0/g," ").trim().split(/\n+/);
  let out=[];
  for(let i=0;i<lines.length;i+=2){
    if(!lines[i+1]) break;
    let l1=lines[i], l2=lines[i+1];
    let date=l1.match(/\d{2}\/\d{2}\/\d{4}/)?.[0]||"";
    let draw=l2.match(/#\d+/)?.[0]||"";
    let n1=l1.replace(date,"").trim().split(/\s+/).map(Number);
    let n2=l2.replace(draw,"").trim().split(/\s+/).map(Number);
    let nums=[...n1,...n2].filter(n=>n>=1 && n<=80);
    if(nums.length===20) out.push({date,draw,nums});
  }
  return out;
}

function calcStats(){
  let freq=Array(81).fill(0);
  let drought=Array(81).fill(0);
  results.slice(index,index+WINDOW).forEach(r=>r.nums.forEach(n=>freq[n]++));
  for(let n=1;n<=80;n++){
    for(let i=index;i<Math.min(results.length,index+WINDOW);i++){
      if(results[i].nums.includes(n)) break;
      drought[n]++;
    }
  }
  return {freq,drought};
}

function getMaxDrought(d){
  let m=0;
  for(let i=1;i<=80;i++) if(d[i]>m) m=d[i];
  return m;
}

function render(){
  if(!results.length) return;
  let cur=results[index];
  let prev=index+1<results.length?results[index+1].nums:[];
  let {freq,drought}=calcStats();
  let maxDrought=getMaxDrought(drought);

  document.getElementById("info").innerText=`Ng√†y ${cur.date} ‚Äì K·ª≥ ${cur.draw}`;
  let tb=document.getElementById("board");
  tb.innerHTML="";
  let n=1;

  for(let r=0;r<8;r++){
    let tr=document.createElement("tr");
    for(let c=0;c<10;c++){
      let td=document.createElement("td");
      td.textContent=n.toString().padStart(2,"0");

      if(cur.nums.includes(n)) td.classList.add("hit");
      if(prev.includes(n)) td.classList.add("prev-hit");

      if(freq[n]>=6) td.classList.add("hot3");
      else if(freq[n]>=4) td.classList.add("hot2");
      else if(freq[n]===3) td.classList.add("hot1");

      if(drought[n]>=8) td.classList.add("cold3");
      else if(drought[n]>=6) td.classList.add("cold2");
      else if(drought[n]>=4) td.classList.add("cold1");

      if(drought[n]===maxDrought && maxDrought>=4){
        td.classList.add("max-cold");
      }

      tr.appendChild(td);
      n++;
    }
    tb.appendChild(tr);
  }
}

function older(){ if(index+1<results.length){ index++; render(); } }
function newer(){ if(index>0){ index--; render(); } }

async function loadKenoAuto(){
  const url="https://raw.githubusercontent.com/vietvudanh/vietlott-data/master/data/keno.json";
  const data=await fetch(url).then(r=>r.json());
  let text="";
  data.slice(0,20).forEach(d=>{
    let date=d.drawDate||"";
    let draw="#"+d.drawId;
    text+=date+"\t"+d.numbers.slice(0,10).join(" ")+"\n";
    text+=draw+"\t"+d.numbers.slice(10).join(" ")+"\n";
  });
  document.getElementById("raw").value=text.trim();
  results=parseData();
  render();
}

loadKenoAuto();
</script>

</body>
</html>
