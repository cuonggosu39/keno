<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Keno ‚Äì Th·ªëng k√™ Hot / Cold</title>

<style>
:root{
  --cell-width:75px;
  --cell-height:55px;
  --font-btn:18px;
  --font-cell:22px;
}
body{
  font-family: Arial, sans-serif;
  background:#fff;
  margin:0;
  padding:15px;
  text-align:center;
}
h2{ margin-bottom:6px; }
#countdown{
  font-size:20px;
  color:#d32f2f;
  font-weight:bold;
  margin-bottom:6px;
}
button{
  font-size:var(--font-btn);
  padding:8px 18px;
  margin:6px;
  cursor:pointer;
  border-radius:6px;
}
#info{
  font-size:22px;
  font-weight:bold;
  margin:10px 0;
  white-space:pre-line;
}
.nav{ margin-bottom:10px; }
#board{
  margin:0 auto;
  border-collapse:collapse;
}
#board td{
  width:var(--cell-width);
  height:var(--cell-height);
  border:1px solid #aaa;
  font-size:var(--font-cell);
  text-align:center;
  vertical-align:middle;
  position: relative;
}
#board td:nth-child(5){ border-right:3px solid #000; }
#board tr:nth-child(4) td{ border-bottom:3px solid #000; }
.hit{ background:#4caf50; color:#fff; }
.prev-hit{
  text-decoration: underline;
  text-decoration-thickness: 3px;
  text-underline-offset: 6px;
}
.hot1{ color:#ffcc80; font-weight:bold; }
.hot2{ color:#ff9800; font-weight:bold; }
.hot3{ color:#e65100; font-weight:bold; }
.cold1{ color:#90caf9; }
.cold2{ color:#1e88e5; font-weight:bold; }
.cold3{ color:#0d47a1; font-weight:bold; }
.note{
  max-width:1200px;
  margin:20px auto;
  font-size:16px;
  line-height:1.6;
  text-align:left;
  padding:0 10px;
}
.note-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap:12px;
}
.note-grid > div{
  background:#fafafa;
  padding:10px 12px;
  border-radius:6px;
}
.note-title{ grid-column:1 / -1; }
.note-footer{
  grid-column:1 / -1;
  text-align:center;
  color:#555;
}
@media (max-width:600px){
  :root{
    --cell-width:50px;
    --cell-height:45px;
    --font-btn:22px;
    --font-cell:16px;
  }
  #info{ font-size:18px; }
}
</style>
</head>

<body>

<h2>Keno ‚Äì Th·ªëng k√™ Hot / Cold (10 k·ª≥ g·∫ßn nh·∫•t)</h2>
<div id="countdown"></div>
<div id="info"></div>

<div class="nav">
  <button onclick="newer()">‚óÄ</button>
  <button onclick="older()">‚ñ∂</button>
</div>

<table id="board"></table>

<div class="note note-grid">
  <div class="note-title"><b>Gi·∫£i th√≠ch cho kh√°ch xem:</b></div>
  <div>üü¢ <b>N·ªÅn xanh</b>: s·ªë tr√∫ng k·ª≥ ƒëang xem<br>‚ñ¨ <b>G·∫°ch ch√¢n</b>: k·ª≥ li·ªÅn tr∆∞·ªõc</div>
  <div>üî• <b>HOT</b>: xu·∫•t hi·ªán nhi·ªÅu trong 10 k·ª≥</div>
  <div>‚ùÑ <b>COLD</b>: s·ªë gan</div>
  <div class="note-footer"><i>Ch·ªâ mang t√≠nh tham kh·∫£o</i></div>
</div>

<script>
let results=[];
let index=0;
const WINDOW=10;

/* ===== LOAD DATA T·ª∞ ƒê·ªòNG T·ª™ GITHUB ACTION ===== */
async function loadKenoData(){
  const res = await fetch("data/keno.json");
  const json = await res.json();

  const items = json.data.items; // <-- ƒê√öNG CH·ªñ

  results = items.map(it => {
    let nums = [];
    for(let i=1;i<=20;i++){
      nums.push(parseInt(it["num"+i],10));
    }
    return {
      date: it.openDate.split(" ")[0],
      draw: "#"+it.drawCode,
      time: it.openDate,
      nums: nums
    };
  });

  startCountdown(results[0].time);
  render();
}
/* ===== COUNTDOWN K·ª≤ TI·∫æP THEO (5 PH√öT / K·ª≤) ===== */
function startCountdown(drawTime){
  // drawTime: "31/12/2025 18:24:00"
  const [datePart, timePart] = drawTime.split(" ");
  const [d, m, y] = datePart.split("/").map(Number);
  const [hh, mm, ss] = timePart.split(":").map(Number);

  const last = new Date(y, m-1, d, hh, mm, ss);
  const next = new Date(last.getTime() + 5*60*1000); // +5 ph√∫t

  setInterval(()=>{
    const now = new Date();
    let diff = Math.max(0, next - now);
    let min = Math.floor(diff / 60000);
    let sec = Math.floor((diff % 60000) / 1000);

    document.getElementById("countdown").innerText =
      `‚è≥ K·ª≥ ti·∫øp theo sau: ${min}:${sec.toString().padStart(2,"0")}`;
  },1000);
}
function calcStats(){
  let freq=Array(81).fill(0);
  let drought=Array(81).fill(0);
  results.slice(index,index+WINDOW).forEach(r=>r.nums.forEach(n=>freq[n]++));
  for(let n=1;n<=80;n++){
    for(let i=index;i<Math.min(results.length,index+WINDOW);i++){
      if(results[i].nums.includes(n)) break;
      drought[n]++;
    }
  }
  return {freq,drought};
}

function render(){
  if(!results.length) return;
  let cur=results[index];
  let prev=index+1<results.length?results[index+1].nums:[];
  let {freq,drought}=calcStats();
  document.getElementById("info").innerText=`Ng√†y ${cur.date} ‚Äì K·ª≥ ${cur.draw}`;
  let tb=document.getElementById("board");
  tb.innerHTML="";
  let n=1;
  for(let r=0;r<8;r++){
    let tr=document.createElement("tr");
    for(let c=0;c<10;c++){
      let td=document.createElement("td");
      td.textContent=n.toString().padStart(2,"0");
      if(cur.nums.includes(n)) td.classList.add("hit");
      if(prev.includes(n)) td.classList.add("prev-hit");
      if(freq[n]>=6) td.classList.add("hot3");
      else if(freq[n]>=4) td.classList.add("hot2");
      else if(freq[n]===3) td.classList.add("hot1");
      if(drought[n]>=8) td.classList.add("cold3");
      else if(drought[n]>=6) td.classList.add("cold2");
      else if(drought[n]>=4) td.classList.add("cold1");
      tr.appendChild(td);
      n++;
    }
    tb.appendChild(tr);
  }
}

function older(){if(index+1<results.length){index++;render();}}
function newer(){if(index>0){index--;render();}}

loadKenoData();
</script>

</body>
</html>


